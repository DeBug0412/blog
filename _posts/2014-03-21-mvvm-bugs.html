---
layout: post
title: MVVM中的bug
tags:
- javascript
---

本文专门记录我再做MVVM时遇到的难点和bug

#### 无法触发刷新

场景

```html
<h1>{{tasks.length - activeCount}} remain</h1>
```

为什么会无法触发呢？触发的条件是属性修改(add, update, delete). 而需要注意的是model仅仅observe自己的属性, 并不会知道嵌套属性的修改. 因此, activeCount修改, h1的内容会轻松的变化, 然而tasks length属性的变化(删除task)却无法触发刷新, 因为length已经属于tasks这个scope的东西了

解决方法: 

1. 不再以model作为刷新节点的单位, 只要是属性修改, 全部节点刷新, 这势必带来不必要的性能损失, 我个人非常喜欢model控制一片的概念, 这个方法必然否决
2. 还没想出来...
3. 是否可以手动触发父model的刷新?
4. 是否可以改一种写法, 放弃子model刷新父model, 增加手动触发刷新的接口, 如model.refresh
